{% extends "admin-index.html" %}

{% block actions %}
<li><a onclick="updateSide({{page.id}});"><img src="images/disk.png" width="16" height="16" alt="" /> Save page</a></li>
{% endblock %}

{% block canvas %}
<div id="headline">{% if page %}Edit page #{{page.id}}{% else %}Opret ny side{% endif %}</div>
<form action="" method="post" onsubmit="return updateSide({{page.id}});">
    <input type="submit" accesskey="s" style="width:1px; height:1px; position:absolute; top: -20px; left:-20px;" />
    <script type="text/javascript"><!--
    initRTE("/admin/rtef/images/", "/admin/rtef/", "/theme/rtef-text.css", true);
    //--></script>
    <input type="hidden" name="id" id="id" value="{{page.id}}" />
    <div>
        <input class="admin_name" type="text" name="navn" id="navn" value="{{page.title}}" maxlength="127" size="127" style="width:{{textWidth + 19}}px" />
        <script type="text/javascript"><!--
        writeRichText("text", {{page.html|trim|json_encode()|raw}}, "", {{textWidth + 32}}, 420, true, false, false);
        //--></script>
        Search word (separate search words with a comma 'Emergency Blanket, Emergency Blanket'):<br />
        <textarea name="keywords" id="keywords" style="width:{{textWidth}}px;max-width:{{textWidth}}px" rows="2" cols="">{{page.keywords}}</textarea>
    </div>
    <div class="toolbox">
        <a class="menuboxheader" id="beskrivelseboxheader" style="width:{{thumbWidth + 14}}px" onclick="showhide('beskrivelsebox',this);">
            Description:
        </a>
        <div style="text-align:center;width:{{thumbWidth + 34}}px{% if hide.description %};display:none{% endif %}" id="beskrivelsebox">
            <br />
            <input type="hidden" value="{% if page.imagePath %}{{page.imagePath}}{% else %}/images/web/intet-foto.jpg{% endif %}" id="billed" name="billed" />
            <img id="billedthb" src="{% if page.imagePath %}{{page.imagePath}}{% else %}/images/web/intet-foto.jpg{% endif %}" alt="" onclick="explorer('thb', 'billed')" />
            <br />
            <img onclick="explorer('thb', 'billed')" src="images/folder_image.png" width="16" height="16" alt="Pictures" title="Find image" />
            <img onclick="setThb('billed','','/images/web/intet-foto.jpg')" src="images/cross.png" alt="X" title="Remove picture" width="16" height="16" />
            <script type="text/javascript"><!--
            writeRichText("beskrivelse", {{page.excerpt|trim|json_encode()|raw}}, "", {{thumbWidth + 32}}, 115, false, false, false);
            //--></script>
        </div>
    </div>
    <div class="toolbox">
        <a class="menuboxheader" id="priserheader" style="width:261px" onclick="showhide('priser',this);">Price: </a>
        <div style="width:281px{% if hide.prices %};display:none{% endif %}" id="priser">
            <table style="width:100%">
                <tr>
                    <td>
                        <select name="burde" id="burde">
                            <option value="0"{% if page.oldPriceType == 0 %} selected="selected"{% endif %}>Before</option>
                            <option value="1"{% if page.oldPriceType == 1 %} selected="selected"{% endif %}>Indicative price</option>
                            <option value="2"{% if page.oldPriceType == 2 %} selected="selected"{% endif %}>Should cost</option>
                        </select>
                    </td>
                    <td style="text-align:right">
                        <input class="XPris" onkeypress="return checkForInt(event)" onchange="prisHighlight()" value="{{page.oldPrice}}" name="for" id="for" size="11" maxlength="11" style="width:100px;text-align:right" />
                        ,-
                    </td>
                </tr>
                <tr>
                    <td>
                        <select name="fra" id="fra">
                            <option value="0"{% if page.priceType == 0 %} selected="selected"{% endif %}>Price</option>
                            <option value="1"{% if page.priceType == 1 %} selected="selected"{% endif %}>From</option>
                            <option value="2"{% if page.priceType == 2 %} selected="selected"{% endif %}>Used</option>
                        </select>
                    </td>
                    <td style="text-align:right">
                        <input value="{{page.price}}" class="{% if page.oldPrice %}NyPris{% else %}Pris{% endif %}" name="pris" id="pris" size="11" maxlength="11" style="width:100px;text-align:right" onkeypress="return checkForInt(event)" onchange="prisHighlight()" />
                        ,-
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="toolbox">
        <a class="menuboxheader" id="miscboxheader" style="width:250px" onclick="showhide('miscbox',this);">
            Other:
        </a>
        <div style="width:270px{% if hide.misc %};display:none{% endif %}" id="miscbox">
            SKU:
            <input type="text" name="varenr" id="varenr" maxlength="63" style="text-align:right;width:128px" value="{{page.sku}}" />
            <br />
            <img src="images/page_white_key.png" width="16" height="16" alt="" />
            <select id="krav" name="krav">
                {% for requirementId, name in requirementOptions %}
                <option{% if page.requirement.id == requirementId %} selected="selected"{% endif %} value="{{requirementId}}">
                    {{name}}
                </option>
                {% endfor %}
            </select>
            <br />
            <img width="16" height="16" alt="" src="images/page_white_medal.png" />
            <select id="maerke" name="maerke" size="10">
                {% for id, name in brandOptions %}
                <option{% if brandId == id %} selected="selected"{% endif %} value="{{id}}">{{name}}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    {% if page %}
    <div class="toolbox">
        <a class="menuboxheader" id="listboxheader" style="width:{{textWidth - 20 + 32}}px" onclick="showhide('listbox',this);">
            Lists:
        </a>
        <div style="width:{{textWidth + 32}}px{% if hide.listbox %};display:none{% endif %}" id="listbox">
            {% spaceless %}
            {% for table in page.tables %}
            <table>
                <thead>
                    <tr>
                        {% for column in table.columns %}
                        <td>{{column.title}}</td>
                        {% endfor %}
                        {% if table.hasLinks %}
                        <td><img src="images/link.png" alt="Link" title="" width="16" height="16" /></td>
                        {% endif %}
                        <td style="width:32px;"></td>
                    </tr>
                </thead>
                <tfoot>
                    <tr id="list{{table.id}}footer">
                        {% for column in table.columns %}
                        {% if column.sorting == 0 %}
                        <td><input style="display:none;{% if column.type != 0 %}text-align:right;{% endif %}" /></td>
                        {% else %}
                        <td>
                            <select style="display:none;">
                                <option value=""></option>
                                {% for option in column.options %}
                                <option value="{{option}}">{{option}}</option>
                                {% endfor %}
                            </select>
                        </td>
                        {% endif %}
                        {% endfor %}
                        {% if table.hasLinks %}
                        <td><input style="display:none;text-align:right;" /></td>
                        {% endif %}
                        <td>
                            <img onclick="listInsertRow({{table.id}});" src="images/disk.png" alt="Edit" title="Edit" width="16" height="16" />
                        </td>
                    </tr>
                </tfoot>
                <tbody id="list{{table.id}}rows">
                    {% if table.rows %}
                    {% for row in table.rows %}
                    <tr id="list_row{{row.id}}"{% if loop.index is even %} class="altrow"{% endif %}>
                        {% for columnId, column in table.columns %}
                        {% if column.sort == 0 %}
                        <td{% if column.type %} style="text-align:right;"{% endif %}>
                            <input value="{{row[columnId]}}" style="display:none;{% if column.type %}text-align:right;{% endif %}" />
                            <span>{{row[columnId]}}</span>
                        </td>
                        {% else %}
                        <td>
                            <select style="display:none">
                                <option value=""></option>
                                {% for option in column.options %}
                                <option value="{{option}}"{% if row[columnId] == option %} selected="selected"{% endif %}>
                                    {{option}}
                                </option>
                                {% endfor %}
                            </select>
                            <span>{{row[columnId]}}</span>
                        </td>
                        {% endif %}
                        {% endfor %}
                        {% if table.hasLink %}
                        <td style="text-align:right;">
                            <input value="{{row.link}}" style="display:none;text-align:right;" />
                            <span>{{row.link}}</span>
                        </td>
                        {% endif %}
                        <td>
                            <img onclick="listEditRow({{table.id}}, {{row.id}});" src="images/application_edit.png" alt="Edit" title="Edit" width="16" height="16" />
                            <img onclick="listUpdateRow({{table.id}}, {{row.id}});" style="display:none" src="images/disk.png" alt="Edit" title="Edit" width="16" height="16" />
                            <img onclick="listRemoveRow({{table.id}}, {{row.id}});" src="images/cross.png" alt="X" title="Delete row" />
                        </td>
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
            </table>
            <script type="text/javascript"><!--
            Event.observe(window, 'load', function() { listSizeFooter({{table.id}}); });
            listlink[{{table.id}}] = {{table.hasLink|json_encode()|raw}};
            --></script>
            {% endfor %}
            {% endspaceless %}
            <input type="button" onclick="window.open('addlist.php?id={{page.id}}', 'addlist','toolbar=0,height=250');" value="Add list">
        </div>
    </div>
</form>
<form action="" method="post" onsubmit="return bind({{page.id}});">
    {% endif %}
    <div class="toolbox">
        <a class="menuboxheader" id="bindingheader" style="width:366px;" onclick="showhide('binding',this);">
            Bindinger:
        </a>
        <div id="binding"{% if hide.binding %} style="display:none;"{% endif %}>
            <div id="bindinger">
                <br />
                {% for bindingId, binding in bindings %}
                <p id="bind{{bindingId}}">
                    <img onclick="slet('bind', {{binding|json_encode()}}, {{bindingId}})" src="images/cross.png" alt="X" title="Remove binding" width="16" height="16" />
                    {{binding}}
                </p>
                {% endfor %}
            </div>
            {% include 'partial-admin-katlist.html' %}
            {% if page %}
            <br />
            <input type="submit" value="Create binding" accesskey="b" />
            {% endif %}
        </div>
    </div>
</form>
{% if page %}
<form action="" method="post" onsubmit="return addAccessory({{page.id}})">
    <div class="toolbox">
        <a class="menuboxheader" id="accessoryheader" style="width:593px;" onclick="showhide('tilbehor',this);">
            Accessories:
        </a>
        <div id="tilbehor"{% if hide.tilbehor %} style="display:none;"{% endif %}>
            <div id="accessories">
                <br />
                {% for accessory in page.accessories %}
                <p id="accessory{{accessory.id}}">
                    <img onclick="removeAccessory({{accessory.title|json_encode()}}, {{page.id}}, {{accessory.id}})" src="images/cross.png" alt="X" title="Remove binding" width="16" height="16" />
                    {{accessory.title}}
                </p>
                {% endfor %}
            </div>
            <div><iframe id="accessoryFrame" src="pagelist.php" width="100%" height="300"></iframe></div>
            <br />
            <input type="submit" value="Add accessories" accesskey="a" />
        </div>
    </div>
</form>
{% endif %}
{% endblock %}
